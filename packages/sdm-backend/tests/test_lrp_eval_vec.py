# pylint: disable=invalid-name

"""
Test vectors from AN12304
"""

import binascii

from libsdm.lrp import LRP


def execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES):
    KEY = binascii.unhexlify(KEY)
    RES = binascii.unhexlify(RES)
    FINALIZE = FINALIZE == 1

    assert LRP.eval_lrp(LRP.generate_plaintexts(KEY), LRP.generate_updated_keys(KEY)[UPDATEDKEY], IV, FINALIZE)\
        .hex().upper() == RES.hex().upper()


def test_vec1():
    KEY = "567826B8DA8E768432A9548DBE4AA3A0"
    IV = "1359"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "1BA2C0C578996BC497DD181C6885A9DD"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec2():
    KEY = "B65557CE0E9B4C5886F232200113562B"
    IV = "BB4FCF27C94076F756AB030D"
    FINALIZE = 0
    UPDATEDKEY = 1
    RES = "6FDFA8D2A6AA8476BF94E71F25637F96"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec3():
    KEY = "88B95581002057A93E421EFE4076338B"
    IV = "77299D"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "E9C04556A214AC3297B83E4BDF46F142"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec4():
    KEY = "C48A8E8B16571645A1557825AA66AC91"
    IV = "1F0B7C0DB12889CA436CABB78BE42F9"
    FINALIZE = 1
    UPDATEDKEY = 3
    RES = "51296B5E6D3B8DB8A1A7399760A19189"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec5():
    KEY = "CAF3750AFF93F9A0C8861BCCCCDF1A9D"
    IV = "9273B7"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "468C2BFCF993E7F112E150C17298A968"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec6():
    KEY = "65024B14AA99E9CA93F51172E19EE000"
    IV = "826CE8A26DFE768D91"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "A3830865D52EAEBC6471CDBD3DFC0A89"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec7():
    KEY = "1EDB9D253DF18D72BEEAE960B6FDF325"
    IV = "FD7BBC6CE819F04AF0C3944C9E"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "B73B50D4BA439DF9D4AFB79FF10F1446"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec8():
    KEY = "08CFACB758EB34F0106D42358F22B5EB"
    IV = "431B8F155EB1F28334F201CADD7"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "40C01FC5DF4C142D9C9721F74A373BA5"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec9():
    KEY = "CC57E7503BCCCF260D6B4E2AB38ACE94"
    IV = "4D09838DF371FAC5D5B641EE45"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "C1A465936A097FF76FCAF18166E8DF60"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec10():
    KEY = "D0E9C3CACE9A747A74F582AA0F873FF9"
    IV = "FCB69068C83E64765676F718E41E25"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "A944D5A19C5B86392CC3CFC58F57C321"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec11():
    KEY = "59C9C703C66A9FD2948E0A48617285DC"
    IV = "F28EFF672184665744FD835B106484"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "F078390B345FC6E22EE9A75B3D8BF490"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec12():
    KEY = "2E763263979117BED33A331B15E3F01B"
    IV = "2B96BFF1A8429C6E"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "9193DA3870AA345EB4FDFB5EE4A35E61"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec13():
    KEY = "A14E397DA6C410440FA9EC4C61774094"
    IV = "4B42600D"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "21C0B442BF41B7DDD80D4A99CD7B7B81"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec14():
    KEY = "921038ED913CCEEFC6286B756F9ABC8D"
    IV = "9FE171DCB4CA1F7E5"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "9FF1DBB5E8528E56370EB55919642AC0"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec15():
    KEY = "F2512BC694E7A66D6ED67E0841BA2523"
    IV = "D0F92AC3F33EC12CF5B65C6ECE12DE0"
    FINALIZE = 1
    UPDATEDKEY = 3
    RES = "6271F38386E7399D7FA1709A72B4F585"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec16():
    KEY = "75FCA5E188F44F1E808597A0B7B690D4"
    IV = "64962F5DED0468F1"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "EBD6F32ED75566E6756A14EC16715CBD"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec17():
    KEY = "1000076C2934BDB02750204704DAA472"
    IV = "8C3E0"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "581C3B057F9312FECF4A7B8070C83B8C"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec18():
    KEY = "99B1647A76CD170EA07997043E1E7919"
    IV = "F"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "BA5F895E8B57F7753EE5C7276E60B37F"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec19():
    KEY = "6983FC665FBB8BEA35DADBB2EF446656"
    IV = "BDF09818B0A7AFFF9C8"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "E0A4144033A1CACD1DBCE30F9883A1DB"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec20():
    KEY = "9FBC2045FA6215B4FD1ABA412DD9C59D"
    IV = "F9B72310BDAE086C51D354B65F1F05F1"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "3F410411D5ED704572D06EDE6AB45CA2"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec21():
    KEY = "1EBB6DF4E251A10B9503AE6B3EEB0ACA"
    IV = "CDD68EFF713C8"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "28740D45D92737D6CF8F05D05B961424"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec22():
    KEY = "415F46BA9A3C3C44A7E1782117668105"
    IV = "590012E84AEC7"
    FINALIZE = 0
    UPDATEDKEY = 2
    RES = "9852EFC35E53F2A4E8DA55770123C99D"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec23():
    KEY = "371A061E4A3065D00F41C4DA68722FFA"
    IV = "52C78A675488D"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "FD2BDCC3EA26AF2069A4C536E3D6B33B"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec24():
    KEY = "E28DFE591559441D04213D889747BC46"
    IV = "414E42E7"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "5E8BF483C2D6DA906EC58D1B63AC9887"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec25():
    KEY = "18A4209AAEF2CFC67E48834ED7D2B62B"
    IV = "4B6E0EBCBB920A0B441114478"
    FINALIZE = 0
    UPDATEDKEY = 0
    RES = "D054F91224DAC4C9E46EDF7EFAB6D179"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec26():
    KEY = "FBBCE5B5F4BF962A345BBF3F13F9E474"
    IV = "D6B8F778C25"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "73C265CD18C9F909784DCFC4CAA5109D"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec27():
    KEY = "8E90A2AEBEB136C000521AEC0037ACFF"
    IV = "B3FD7B7F1026CF70FF71CF8"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "7F519F9B9EAB01EF8DED79520C46770E"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec28():
    KEY = "FA89CC662EF47C75A9887F12A6C9879F"
    IV = "B9"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "4973ECE66EEE903D4761EF3960210735"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec29():
    KEY = "3F0E5E6D0F7F7BDE4DB2C4F074D02062"
    IV = "7D0AA4C30A75FC6C6A5D47D12247"
    FINALIZE = 1
    UPDATEDKEY = 3
    RES = "87F43A64DAF93DF744F54FECE1A480AB"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec30():
    KEY = "B443EC2B5E56AF789D27F6C38F9DD6A9"
    IV = "0CACAE327B04E870A3151E967"
    FINALIZE = 0
    UPDATEDKEY = 0
    RES = "795553EBFA89AD541C0ED2E5F3C4611F"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec31():
    KEY = "7DD9BF8D3337D57ACD92069B13B16CCE"
    IV = "2266169A6882C7E84"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "49F4FFFEA580EC96D5DCACC9E10AA95E"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec32():
    KEY = "B39A5A07AB6746B5DE4875ED9492DF1B"
    IV = "F03704D4806A731"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "635E39AEF94D050B5424E1D967027594"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec33():
    KEY = "E2703DC54BF4E7C63337FFF0AB6BB6F0"
    IV = "35D183BB4C56E8F70B"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "3E537D77DE31EA05C33CE70B4ECE65FA"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec34():
    KEY = "DF19EF9394EE6344A0832AF8ADCBABE4"
    IV = "44CB4DE4352D3E45F5"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "80F1A5169142107FF0873BC4222E8173"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec35():
    KEY = "24E6DD53E9FEE719486C5CBD07714FC8"
    IV = "24B80F682AF9B33"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "4FA0477728E34E1408D98643F8124035"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec36():
    KEY = "FAE4C2544FF93C20BAA6D60FAFE4919B"
    IV = "87C4DB"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "FD2847D87ADC24C27FA042D1DCA1459B"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec37():
    KEY = "6D1902203D17BCBCE3A0A961EC358517"
    IV = "CA5195213C2C75D37DCC6A67"
    FINALIZE = 1
    UPDATEDKEY = 3
    RES = "2EADE5706A4BCD7CAF844DE01B127CE0"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec38():
    KEY = "7BC16676A8522EBC2564FEC235654DF8"
    IV = "A885"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "9819FE9556933E1CFC4E99C8BF64ACFA"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec39():
    KEY = "F989FF4BDDD5AB6999EF517B742EA085"
    IV = "C4DE07A5E"
    FINALIZE = 0
    UPDATEDKEY = 0
    RES = "D6FEE60DBC8BA533E320ED1D18076D82"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec40():
    KEY = "5F07C727DA21B6C1E2688237672BCB7D"
    IV = "8C74AC47C037AD729D38E3A"
    FINALIZE = 0
    UPDATEDKEY = 0
    RES = "6021FC212F818102027C61FCE28D382C"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec41():
    KEY = "549C67ECD60E848F773990990CAC681E"
    IV = "475BB41878EB17468F7A68847DDD3BAC"
    FINALIZE = 1
    UPDATEDKEY = 3
    RES = "C3B5EE74A722E784887C4C9FDB497855"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec42():
    KEY = "9AFF3EF56FFEC3153B1CADB48B445409"
    IV = "4B073B247CD48F7E0A"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "909415E5C8BE77563050F2227E17C0E4"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec43():
    KEY = "F2BBB25D607ECD1E551CD75CF0033CCE"
    IV = "0335137B5641EFA4F176836A65F0F49"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "87832A9AF79C6CE436EA4DB6CAB18203"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec44():
    KEY = "806A50530D7735B40AC4EF1638E8AD6A"
    IV = "D4137764716DBC8C579BEAB7E76754E"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "CF991392F0369350A7E21BE52F748821"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec45():
    KEY = "64193EF6BDDDC74C7C008DB98ED5FF67"
    IV = "89AB"
    FINALIZE = 1
    UPDATEDKEY = 3
    RES = "4A828E35DBADF6A465321363717D0D27"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec46():
    KEY = "F9E29780209AC952DD87C2572C4950BF"
    IV = "35AF18F46C2FD3C8C6EB507147CA35A"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "51F3482AB8880850390F4F6D775F5C1F"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec47():
    KEY = "37A6769D43FEFA9F79CA61628BAFA7F1"
    IV = "FB"
    FINALIZE = 1
    UPDATEDKEY = 0
    RES = "81C84283D18071F08DE72AD51B5826B6"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec48():
    KEY = "047568AC57D4DE026C40F7228BDD1819"
    IV = "F1B11"
    FINALIZE = 0
    UPDATEDKEY = 3
    RES = "9CE6BEC0F80FDF7D78B1C219130102E7"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec49():
    KEY = "F36472663A3BA87F3E76399C66C23EC9"
    IV = "1FF73338D23ED6AE968"
    FINALIZE = 1
    UPDATEDKEY = 1
    RES = "36DA0902796F4682034DB07D0FF58E28"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)


def test_vec50():
    KEY = "906249E5AF810339F199A25AEC0281E8"
    IV = "56DA443282912622BB92338F8CA"
    FINALIZE = 1
    UPDATEDKEY = 2
    RES = "317600A76B5A7984A681D1D8855F86FC"
    execute_test(KEY, IV, FINALIZE, UPDATEDKEY, RES)
